<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Dashboard - Test Pipeline v2</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@unocss/runtime/uno.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lucide-vue-next@latest/dist/lucide-vue-next.iife.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <link rel="stylesheet" href="shared/tokens.css">
  <link rel="stylesheet" href="shared/components.css">
  <script src="shared/mock-data.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    [v-cloak] { display: none; }
  </style>
</head>
<body class="bg-slate-2 dark:bg-slate-2 text-slate-12 dark:text-slate-12 antialiased">

  <div id="app" v-cloak class="h-screen w-screen overflow-hidden flex">
    <!-- Desktop Sidebar -->
    <aside v-if="!isMobile" class="w-64 bg-slate-1 dark:bg-slate-1 border-r border-slate-6 dark:border-slate-6 flex flex-col">
      <div class="p-4 border-b border-slate-6 dark:border-slate-6">
        <a href="landing-v1.html" class="flex items-center gap-2 font-bold text-lg">
          <icon-test-tube-2 class="text-primary-9"></icon-test-tube-2>
          <span>Test Pipeline v2</span>
        </a>
      </div>
      <nav class="flex-1 p-4 space-y-2">
        <a href="#" class="nav-item active">
          <icon-layout-dashboard :size="20"></icon-layout-dashboard>
          <span>Dashboard</span>
        </a>
        <a href="landing-v1.html" class="nav-item">
          <icon-home :size="20"></icon-home>
          <span>Landing Page</span>
        </a>
      </nav>
      <div class="p-4 border-t border-slate-6 dark:border-slate-6">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-full bg-slate-5 dark:bg-slate-5 flex items-center justify-center font-bold">D</div>
          <div>
            <p class="font-semibold">Developer</p>
            <p class="text-sm text-slate-11 dark:text-slate-11">dev@example.com</p>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden">
      <main class="flex-1 overflow-y-auto p-4 md:p-8">
        <header class="mb-8">
          <h1 class="text-3xl font-bold">Dashboard</h1>
          <p class="text-slate-11 dark:text-slate-11">Overview of your tasks.</p>
        </header>

        <!-- Task List -->
        <div class="space-y-4">
          <div v-if="loading" class="text-center p-8">Loading tasks...</div>
          <div v-else-if="tasks.length === 0" class="text-center p-8">No tasks found.</div>
          <div v-else v-for="task in tasks" :key="task.id" class="card p-4 flex items-center justify-between">
            <div class="flex items-center gap-4">
              <icon-check-square class="text-slate-10 dark:text-slate-10"></icon-check-square>
              <div>
                <p class="font-medium">{{ task.title }}</p>
                <span class="badge" :class="getStatusClass(task.status)">{{ task.status }}</span>
              </div>
            </div>
            <div class="text-sm text-slate-11 dark:text-slate-11">
              Due: {{ new Date(task.dueDate).toLocaleDateString() }}
            </div>
          </div>
        </div>
      </main>

      <!-- Mobile Bottom Nav -->
      <nav v-if="isMobile" class="h-16 bg-slate-1 dark:bg-slate-1 border-t border-slate-6 dark:border-slate-6 flex items-center justify-around">
        <a href="#" class="flex flex-col items-center gap-1 text-primary-9">
          <icon-layout-dashboard :size="24"></icon-layout-dashboard>
          <span class="text-xs">Dashboard</span>
        </a>
        <a href="landing-v1.html" class="flex flex-col items-center gap-1 text-slate-11 dark:text-slate-11">
          <icon-home :size="24"></icon-home>
          <span class="text-xs">Landing</span>
        </a>
        <a href="#" class="flex flex-col items-center gap-1 text-slate-11 dark:text-slate-11">
          <icon-user-circle :size="24"></icon-user-circle>
          <span class="text-xs">Profile</span>
        </a>
      </nav>
    </div>
  </div>

  <script>
    const { createApp, ref, onMounted, onUnmounted } = Vue
    const App = {
      setup() {
        const isMobile = ref(window.innerWidth < 768)
        const tasks = ref([])
        const loading = ref(true)

        const checkScreenSize = () => {
          isMobile.value = window.innerWidth < 768
        }

        const getStatusClass = (status) => {
          switch (status) {
            case 'Done': return 'badge-green';
            case 'In Progress': return 'badge-yellow';
            case 'Todo': return 'badge-slate';
            default: return 'badge-slate';
          }
        }

        onMounted(async () => {
          try {
            await mockDb.init()
            tasks.value = await mockDb.get('tasks')
          } catch (e) {
            console.error('Failed to load tasks:', e)
          } finally {
            loading.value = false
          }
          window.addEventListener('resize', checkScreenSize)
        })

        onUnmounted(() => {
          window.removeEventListener('resize', checkScreenSize)
        })

        return { isMobile, tasks, loading, getStatusClass }
      },
      components: {
        'icon-test-tube-2': lucide.TestTube2,
        'icon-layout-dashboard': lucide.LayoutDashboard,
        'icon-home': lucide.Home,
        'icon-user-circle': lucide.UserCircle,
        'icon-check-square': lucide.CheckSquare,
      }
    }

    const app = createApp(App)
    app.mount('#app')
  </script>
</body>
</html>